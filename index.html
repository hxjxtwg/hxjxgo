<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>导航</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>我的导航</h1>
            <p>一个简洁、快速的个人导航页面。</p>
        </header>
        
        <!-- 新增的网站导航栏 -->
        <nav class="main-nav">
            <ul>
                <li><a href="#">首页</a></li>
                <li><a href="#">博客</a></li>
                <li><a href="#">项目</a></li>
                <li><a href="#">关于我</a></li>
            </ul>
        </nav>

        <main id="links-container">
            <p class="loading">正在从云端加载链接...</p>
        </main>
    </div>

    <script>
        const linksContainer = document.getElementById('links-container');
        
        // 为没有指定颜色的卡片提供一个漂亮的备用色板
        const colorPalette = [
            '#5E35B1', '#3949AB', '#1E88E5', '#00ACC1', '#00897B',
            '#43A047', '#F4511E', '#D81B60', '#8E24AA', '#546E7A'
        ];
        let colorIndex = 0;

        // 函数：创建链接分组并填充到页面
        function createLinkGroups(linkGroups) {
            linksContainer.innerHTML = ''; // 清空加载提示
            linkGroups.forEach(group => {
                const groupDiv = document.createElement('div');
                groupDiv.className = 'link-group';

                const title = document.createElement('h2');
                title.textContent = group.title;
                groupDiv.appendChild(title);

                const ul = document.createElement('ul');
                group.links.forEach(link => {
                    const li = document.createElement('li');
                    const a = document.createElement('a');
                    a.href = link.url;
                    a.target = "_blank";
                    a.rel = "noopener noreferrer";
                    a.textContent = link.name;

                    // --- 核心改动：设置背景色 ---
                    // 如果链接数据中有 color 属性，并且格式正确，则使用它
                    if (link.color && /^#[0-9A-F]{6}$/i.test(link.color)) {
                        a.style.backgroundColor = link.color;
                    } else {
                        // 否则，从备用色板中循环取色
                        a.style.backgroundColor = colorPalette[colorIndex % colorPalette.length];
                        colorIndex++;
                    }
                    
                    li.appendChild(a);
                    ul.appendChild(li);
                });
                groupDiv.appendChild(ul);
                linksContainer.appendChild(groupDiv);
            });
        }

        // 页面加载时获取数据
        window.addEventListener('load', async () => {
            try {
                const response = await fetch('/api/links');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const linkGroups = await response.json();
                createLinkGroups(linkGroups);
            } catch (error) {
                console.error("加载链接失败:", error);
                linksContainer.innerHTML = '<p class="error">加载链接失败，请检查后台配置或网络连接。</p>';
            }
        });
    </script>
</body>
</html>

